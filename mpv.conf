# Video
profile=gpu-hq
tone-mapping=hable

scale=ewa_lanczos
dscale=mitchell
linear-downscaling=no
sigmoid-upscaling=no

glsl-shaders="~~/shaders/FSRCNNX_x2_8-0-4-1.glsl"
glsl-shaders-append="~~/shaders/SSimSuperRes.glsl"
glsl-shaders-append="~~/shaders/SSimDownscaler.glsl"

gpu-shader-cache-dir="~~/shaders/cache"

# Suppress useless warnings
msg-level=input=error,demux=error

# Bindings
no-input-default-bindings

# Window
keep-open
no-border
force-window
geometry=50%:50%
autofit-larger=90%x90%
autofit-smaller=40%x40%
force-window-position
no-taskbar-progress

# OSC
no-osc
no-osd-bar
osd-duration=2000
osd-font-size=32
osd-border-color="#262626"
cursor-autohide-fs-only
cursor-autohide=500

# Playback
no-pause
reset-on-next-file=pause
force-seekable
image-display-duration=3
volume-max=200
volume=70

# Improve latency for livestreams
demuxer-lavf-o=live_start_index=-1

# youtube-dl
ytdl-format=(bestvideo[vcodec=vp9.2][fps>30][height<=1080]/bestvideo[vcodec^=av01][vcodec*=M.08.][fps>30][height<=1080]/bestvideo[vcodec^=vp9][fps>30][height<=1080]/bestvideo[vcodec^=av01][fps>30][height<=1080]/bestvideo[fps>30][height<=1080]/bestvideo[fps>30]/bestvideo[vcodec=vp9.2][height<=1440]/bestvideo[vcodec^=av01][vcodec*=M.08.][height<=1440]/bestvideo[vcodec^=vp9][height<=1440]/bestvideo[vcodec^=av01][height<=1440]/bestvideo[height<=1440]/bestvideo)+(bestaudio[acodec=opus]/bestaudio)/best[fps>30][height<=1080]/best[fps>30]/best[height<=1440]/best
ytdl-raw-options=write-thumbnail=,write-sub=,sub-format=ass/ssa/srt/best,sub-lang="enGB,en-GB,en,eng,enUS,en-US"

# Screenshots
screenshot-directory=~/Documents/mpv/
screenshot-template="%{?demuxer-via-network==yes:${media-title}%{?demuxer-via-network==yes:_${filename/no-ext}%{!demuxer-via-network==yes:${filename}_%wH%wM%wS.%wT"
screenshot-format=webp
screenshot-high-bit-depth
screenshot-webp-lossless
screenshot-webp-compression=6

# Subtitles
sub-font=Noto Sans
sub-spacing=1
sub-font-size=60
sub-use-margins=no
sub-ass-vsfilter-aspect-compat=no
demuxer-mkv-subtitle-preroll
sub-color="#E6FFFFFF"
sub-border-color="#BE1C1C1C"
sub-filter-sdh

sub-auto=fuzzy
audio-file-auto=fuzzy

# Auto profiles
script-opts=trackselect-enabled=no

[extension.gif]
save-position-on-quit=no
loop-file
no-cache

[extension.webm]
save-position-on-quit=no
loop-file

[extension.mp3]
alpha=blend

[extension.aac]
alpha=blend

[extension.mka]
alpha=blend

[extension.dts]
alpha=blend

[extension.flac]
alpha=blend

[extension.alac]
alpha=blend

[extension.ogg]
alpha=blend

[extension.m4a]
alpha=blend

[extension.ac3]
alpha=blend

[extension.opus]
alpha=blend

[extension.wav]
alpha=blend

[protocol.https]
profile=WEB

[protocol.http]
profile=WEB

[protocol.ytdl]
profile=WEB

[audio]
ytdl-format=bestaudio[acodec=opus]/bestaudio/best[height<=1080]/best
ytdl-raw-options=write-thumbnail=

[compare]
title=Untitled comparison
load-auto-profiles=no
script-opts=trackselect-enabled=no
no-sub
deband=no
glsl-shaders=""
screenshot-format=png
screenshot-directory=~/Documents/mpv-compare/
screenshot-template="%f_%wH%wM%wS.%wT-%{!title==Untitled comparison:${title:}%{video-frame-info/picture-type:X}%{?estimated-frame-count==0:${?estimated-frame-number==0:X}%{?estimated-frame-count==0:${!estimated-frame-number==0:${estimated-frame-number:X}%{!estimated-frame-count==0:${estimated-frame-number:X}"
osd-msg1="Frame ${estimated-frame-number:?}${?estimated-frame-count: of ${estimated-frame-count}}\nPicture type: ${video-frame-info/picture-type:?}\n${!title==Untitled comparison:${title:}}"
osd-msg2="Frame ${estimated-frame-number:?}${?estimated-frame-count: of ${estimated-frame-count}}\nPicture type: ${video-frame-info/picture-type:?}\nInterlaced: ${video-frame-info/interlaced}\nTFF: ${video-frame-info/tff}\nRepeat: ${video-frame-info/repeat}\n${!title==Untitled comparison:${title:}}"

[svp]
input-ipc-server=/tmp/mpvsocket
hr-seek-framedrop=no
resume-playback=no

[Anime]
profile-cond=string.match(string.gsub(require "mp.utils".join_path(get("working-directory", ""), get("path", "")), string.gsub(get("filename", ""), "([^%w])", "%%%1").."$", ""), "Anime")~=nil
profile-restore=copy-equal
alang=ja,jp,jpn,japanese,Japanese,Japanese[jpn]
blend-subtitles
sub-filter-sdh=no
script-opts=trackselect-enabled=yes

[SD]
profile-cond=get("height", 720) < 720 and get("width", 1280) < 1280
profile-restore=copy-equal
sub-gauss=1.0
sub-gray

[UHD]
profile-cond=get("height", 0) > 1080 and get("duration", 1) >= 1
profile-restore=copy
blend-subtitles=no
glsl-shaders=""
dscale=lanczos

[HDR]
profile-cond=p["video-params/primaries"]=="bt.2020" and p["demuxer-via-network"]==false
profile-restore=copy-equal
blend-subtitles=no
deband=no
deband-iterations=1
deband-threshold=64
deband-range=16
deband-grain=48

[WEB]
profile-cond=string.match(get("filename", ""), "WEBRip")==nil and (string.match(get("filename", ""), "WEB")~=nil or string.match(get("filename", ""), "%.web%.")~=nil or string.match(get("filename", ""), "HorribleSubs")~=nil or string.match(get("filename", ""), "Erai-Raws")~=nil or string.match(get("filename", ""), "%[SNAFU]")~=nil)
profile-restore=copy-equal
deband
deband-iterations=2
deband-threshold=35
deband-range=20
deband-grain=5

glsl-shaders="~~/shaders/noise_static_luma.hook"
#glsl-shaders-append="~~/shaders/noise_static_chroma.hook"
glsl-shaders-append="~~/shaders/FSRCNNX_x2_8-0-4-1.glsl"
glsl-shaders-append="~~/shaders/SSimSuperRes.glsl"
glsl-shaders-append="~~/shaders/SSimDownscaler.glsl"

[WEBRip]
profile-cond=string.match(get("filename", ""), "WEBRip")~=nil
deband
deband-iterations=1
deband-threshold=64
deband-range=16
deband-grain=48

glsl-shaders="~~/shaders/FSRCNNX_x2_8-0-4-1.glsl"
glsl-shaders-append="~~/shaders/SSimSuperRes.glsl"
glsl-shaders-append="~~/shaders/SSimDownscaler.glsl"
